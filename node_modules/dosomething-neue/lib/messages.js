"use strict";

var _interopRequire = function (obj) { return obj && obj.__esModule ? obj["default"] : obj; };

/**
 * @module neue/messages
 *
 * Adds "x" close button to messages pattern, and binds
 * a click handler to allow user to dismiss the message.
 */

var $ = _interopRequire(require("jquery"));

var messageClose = "<a href=\"#\" class=\"js-close-message messages__close\"><span>Close</span></a>";

/**
* Adds a close button to system message banner, with optional callback.
*
* @param {jQuery}   $messages  Object containing message divs to be modified.
* @param {function} callback   Callback fired after message is closed.
*/
var attachCloseButton = function attachCloseButton($messages) {
  var callback = arguments[1] === undefined ? null : arguments[1];

  // Create message close button
  $messages.append(messageClose);

  // Close message when "x" is clicked:
  $messages.on("click", ".js-close-message", function (event) {
    event.preventDefault();
    $(this).parent(".messages").slideUp();

    if (callback && typeof callback === "function") {
      callback();
    }
  });
};

// Prepare any messages in the DOM on load
$(document).ready(function () {
  attachCloseButton($(".messages"));
});

module.exports = { attachCloseButton: attachCloseButton };